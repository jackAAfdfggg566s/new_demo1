è¿™ä¸ªæŠ¥é”™éå¸¸å…³é”®ï¼Œè€Œä¸”å®ƒç›´æ¥è§£é‡Šäº†ä½ å‰é¢æ‰€æœ‰ç°è±¡ ğŸ‘‡
æˆ‘ä»¬æŠŠè¯è¯´æ¸…æ¥šä¸€ç‚¹ï¼š
the node was low on resource â‰  Pod OOM
è¿™æ˜¯ Node çº§èµ„æºå‹åŠ› â†’ Pod è¢«é©±é€ï¼ˆEvictedï¼‰
æ‰€ä»¥ä½ ç°åœ¨çœ‹åˆ°çš„ç»“æœï¼Œä¸æ˜¯åº”ç”¨ OOM ç¼ºé™·ï¼Œè€Œæ˜¯â€œèŠ‚ç‚¹èµ„æºæ²»ç†é—®é¢˜â€ã€‚
ä¸€ã€å…ˆç»™ä½ ä¸€å¥è¯ç»“è®ºï¼ˆé‡ç‚¹ï¼‰
è¿™æ˜¯ Node èµ„æºä¸è¶³è§¦å‘çš„ Evictionï¼Œä¸æ˜¯å®¹å™¨ OOMKilledã€‚
ğŸ‘‰ Pod ä¸ä¼šè‡ªåŠ¨æ¢å¤ï¼Œæ˜¯ç¬¦åˆ Kubernetes è®¾è®¡çš„ï¼Œä½†
ğŸ‘‰ å®ƒæš´éœ²çš„æ˜¯é›†ç¾¤å±‚é¢çš„éŸ§æ€§/å®¹é‡ç¼ºé™·ã€‚
äºŒã€the node was low on resource åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ
è¿™æ˜¯ kubelet çš„ Eviction æœºåˆ¶ åœ¨å·¥ä½œï¼š
å®é™…å‘ç”Ÿé“¾è·¯æ˜¯ï¼š
å¤åˆ¶ä»£ç 

ä½ çš„è„šæœ¬ç–¯ç‹‚åƒå†…å­˜
â†’ Node å¯ç”¨å†…å­˜ä¸‹é™
â†’ kubelet è§¦å‘ eviction threshold
â†’ kubelet ä¸»åŠ¨é©±é€ Pod
â†’ Pod çŠ¶æ€ = Evicted / Error
â†’ âŒ æ²¡æœ‰ OOMKilled
ğŸ“Œ å…³é”®åŒºåˆ«
OOMKilledï¼šå†…æ ¸æ€è¿›ç¨‹ï¼ˆcgroupï¼‰
Evictedï¼škubelet æ€ Podï¼ˆNode ä¿æŠ¤ï¼‰
ä¸‰ã€ä½ å¯ä»¥è¿™æ · 100% éªŒè¯è¿™æ˜¯ Evictionï¼ˆä¸æ˜¯çŒœï¼‰
1ï¸âƒ£ describe podï¼ˆä¸€å®šèƒ½çœ‹åˆ°ï¼‰
å¤åˆ¶ä»£ç 
Bash
kubectl describe pod <pod-name>
ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ï¼š
å¤åˆ¶ä»£ç 

Reason:     Evicted
Message:    The node was low on resource: memory.
2ï¸âƒ£ çœ‹ Pod çš„ QoSï¼ˆéå¸¸å…³é”®ï¼‰
å¤åˆ¶ä»£ç 
Bash
kubectl get pod <pod-name> -o jsonpath='{.status.qosClass}'
å¤§æ¦‚ç‡æ˜¯ï¼š
å¤åˆ¶ä»£ç 

BestEffort
æˆ–ï¼š
å¤åˆ¶ä»£ç 

Burstable
ğŸ‘‰ è¿™ç±» Pod æ˜¯ eviction çš„ç¬¬ä¸€æ‰¹ç‰ºç‰²å“
å››ã€ä¸ºä»€ä¹ˆ Pod ä¸ä¼šâ€œè‡ªå·±æ¢å¤â€ï¼ˆè¿™æ˜¯è®¾è®¡ï¼Œä¸æ˜¯ bugï¼‰
å¦‚æœä½ ç°åœ¨æ˜¯ä»¥ä¸‹ä»»ä¸€æƒ…å†µï¼š
åœºæ™¯
æ˜¯å¦è‡ªåŠ¨æ¢å¤
è£¸ Pod
âŒ ä¸ä¼š
Job
âŒ ä¸ä¼š
Deploymentï¼ˆä½† node è¿˜åœ¨å‹åŠ›ä¸­ï¼‰
âŒ å¯èƒ½èµ·ä¸æ¥
Node æŒç»­å†…å­˜ç´§å¼ 
âŒ ä¸€ç›´ Evicted
ğŸ“Œ Eviction çš„ç›®æ ‡æ˜¯ï¼šä¿æŠ¤ Nodeï¼Œä¸æ˜¯ä¿è¯ Pod å¯ç”¨
äº”ã€è¿™ç®—ä¸ç®—â€œç¼ºé™·â€ï¼Ÿâ€”â€”ä¸“ä¸šåˆ¤æ–­æ–¹å¼
âŒ ä¸ç®—åº”ç”¨ç¼ºé™·
å› ä¸ºï¼š
åº”ç”¨æ²¡ OOM
åº”ç”¨æ²¡å´©
æ˜¯ kubelet åœ¨ä¿æŠ¤ Node
âš ï¸ ä½†ç®— å¹³å° / å®¹é‡ / é…ç½®ç¼ºé™·ï¼ˆè¿™ç‚¹å¾ˆé‡è¦ï¼‰
ä»¥ä¸‹ä»»ä¸€æˆç«‹ï¼Œéƒ½å¯ä»¥è®°ç¼ºé™·ï¼š
å•ä¸ª Pod èƒ½åƒå®æ•´ä¸ª Node
æ²¡æœ‰ PodDisruptionBudget
æ²¡æœ‰ resource request / limit
æ²¡æœ‰ node memory headroom
æ²¡æœ‰ eviction-aware è®¾è®¡
ğŸ‘‰ è¿™æ˜¯ SRE / å¹³å°å±‚é¢çš„ç¼ºé™·
å…­ã€ä¸ºä»€ä¹ˆä½ â€œæ€ä¹ˆä¹Ÿæµ‹ä¸åˆ° OOMKilledâ€ï¼ˆæ ¸å¿ƒåŸå› ï¼‰
ä½ ç°åœ¨çš„å®éªŒé¡ºåºæ˜¯ï¼š
å¤åˆ¶ä»£ç 

Node eviction threshold
â†“ï¼ˆå…ˆè§¦å‘ï¼‰
Evicted
â†“
OOMKilledï¼ˆæ ¹æœ¬æ²¡æœºä¼šå‘ç”Ÿï¼‰
ğŸ‘‰ Node eviction æ°¸è¿œä¼˜å…ˆäº Pod OOM
ä¸ƒã€å¦‚æœä½ çš„ç›®æ ‡æ˜¯ã€Œæµ‹è¯• Pod OOMã€ï¼Œå¿…é¡»è¿™æ ·æ”¹
âœ… å…³é”®åŸåˆ™
OOM å¿…é¡»å‘ç”Ÿåœ¨ cgroup å†…ï¼Œè€Œä¸æ˜¯æŠŠ Node æ‰“çˆ†
ä½ è¦åŒæ—¶åšåˆ° 3 ç‚¹ï¼š
1ï¸âƒ£ Pod å¿…é¡»æœ‰æ˜ç¡® memory limitï¼ˆè€Œä¸”è¦å°ï¼‰
å¤åˆ¶ä»£ç 
Yaml
resources:
  requests:
    memory: "32Mi"
  limits:
    memory: "32Mi"
2ï¸âƒ£ è„šæœ¬åªåƒâ€œè¿›ç¨‹å†…å­˜â€ï¼Œä¸åƒ page cache
âœ… æ­£ç¡®ï¼ˆä½ è¯¥ç”¨çš„ï¼‰ï¼š
å¤åˆ¶ä»£ç 
Sh
while true; do
  x=$(head -c 5M /dev/zero)
done
âŒ é”™è¯¯ï¼ˆä¼šæ‰“çˆ† Nodeï¼‰ï¼š
å¤åˆ¶ä»£ç 
Sh
dd if=/dev/zero >> /tmp/file
3ï¸âƒ£ Pod QoS æœ€å¥½æ˜¯ Guaranteed
å¤åˆ¶ä»£ç 
Yaml
requests.memory == limits.memory
è¿™æ ·ï¼š
kubelet ä¸ä¼šä¼˜å…ˆé©±é€ä½ 
æ›´å®¹æ˜“è§¦å‘ OOMKilled
å…«ã€ä½ å¯ä»¥ç›´æ¥ç”¨çš„ã€Œæ­£ç¡® OOM Pod æ¨¡æ¿ã€
å¤åˆ¶ä»£ç 
Yaml
apiVersion: v1
kind: Pod
metadata:
  name: oom-test
spec:
  restartPolicy: Never
  containers:
  - name: oom
    image: busybox
    resources:
      requests:
        memory: "32Mi"
      limits:
        memory: "32Mi"
    command:
      - sh
      - -c
      - |
        while true; do
          x=$(head -c 5M /dev/zero)
        done
ğŸ‘‰ è¿™ä¸ª ä¸ä¼šè§¦å‘ node evictionï¼Œè€Œæ˜¯ ç¨³å®š OOMKilled
ä¹ã€åœ¨æ··æ²Œå·¥ç¨‹æŠ¥å‘Šé‡Œä½ å¯ä»¥è¿™æ ·å®šæ€§ï¼ˆå¾ˆä¸“ä¸šï¼‰
ä½ å¯ä»¥å†™ï¼š
The experiment triggered node-level memory pressure, resulting in pod eviction rather than container OOM.
This reveals a cluster-level capacity and eviction policy gap, rather than an application-level memory handling issue.
åã€ä¸€å¥è¯æ€»ç»“ï¼ˆè®°ä½è¿™æ¡ï¼‰
ä½ ç°åœ¨é‡åˆ°çš„ä¸æ˜¯â€œOOM ä¸æ¢å¤â€ï¼Œè€Œæ˜¯â€œNode è¢«æ‰“çˆ† â†’ Pod è¢«é©±é€â€ï¼Œè¿™æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒå±‚çº§çš„é—®é¢˜ã€‚
å¦‚æœä½ æ„¿æ„ï¼Œä¸‹ä¸€æ­¥æˆ‘å¯ä»¥å¸®ä½ åšä¸‰ä»¶äº‹ä¹‹ä¸€ï¼ˆä½ é€‰ï¼‰ğŸ‘‡
1ï¸âƒ£ è®¾è®¡ä¸€ä¸ª â€œåª OOM Podã€ä¸å½±å“ Nodeâ€ çš„å®éªŒ
2ï¸âƒ£ è®¾è®¡ä¸€ä¸ª â€œNode å†…å­˜è€—å°½ + é©±é€é¡ºåºâ€ çš„å¹³å°çº§æ¼”ç»ƒ
3ï¸âƒ£ å¸®ä½ å†™ä¸€ä»½ å®éªŒç»“è®º / ç¼ºé™·å®šçº§æ¨¡æ¿
ä½ ç°åœ¨è¿™ä¸ª Pod çš„ qosClass æ˜¯ä»€ä¹ˆï¼Ÿ