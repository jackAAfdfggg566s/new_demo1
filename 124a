æ˜ç™½â€”â€”ä½ æƒ³çš„æ˜¯ï¼š
æŠŠæ­£å¸¸ Running/Ready çš„æ’é™¤æ‰ï¼Œåªè¿‡æ»¤å‡ºæœ‰é—®é¢˜çš„ Podï¼ˆFail / Error / CrashLoopBackOff / ImagePullBackOff è¿™äº›ï¼‰ã€‚

ä¸‹é¢ç»™ä½ æœ€å‡†ç¡®ã€æœ€ç®€æ´çš„å‡ ç§ã€‚


---

âœ… æ–¹æ³• 1ï¼šæœ€ç®€å•ï¼ˆç›´æ¥ç”¨ STATUS å­—æ®µè¿‡æ»¤ï¼‰

kubectl get pods --no-headers \
  | grep -E "CrashLoopBackOff|Error|Failed|ImagePullBackOff|Init|Terminating"

è¾“å‡ºçš„éƒ½æ˜¯æœ‰é—®é¢˜çš„ podã€‚


---

âœ… æ–¹æ³• 2ï¼šæ›´å¹²å‡€ï¼Œåªä¿ç•™ä¸æ˜¯ Running çš„ Pod

kubectl get pods --no-headers \
  | awk '$3 != "Running"'

è¿™ä¼šæŠŠ Running çš„æ’é™¤æ‰ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯ï¼š

CrashLoopBackOff

Error

Pending

Failed

Completed

Init ä¸­

Terminating



---

âœ… æ–¹æ³• 3ï¼šåªè¿‡æ»¤ CrashLoopBackOffï¼ˆç²¾å‡†ç‰ˆï¼‰

kubectl get pods --no-headers | grep CrashLoopBackOff


---

âœ… æ–¹æ³• 4ï¼šè¿‡æ»¤ â€œReady ä¸ç­‰äº Trueâ€ çš„ï¼ˆæœ€å‡†ç¡®ï¼Œä¸ä¼šæ¼æ‰å¤šå®¹å™¨ï¼‰

kubectl get pods -o jsonpath='{range .items[*]}{.metadata.name}{"\t"}{.status.conditions[?(@.type=="Ready")].status}{"\n"}{end}' \
  | grep -v True

æ‰€æœ‰ Ready=False æˆ–ç¼ºå¤± Ready æ¡ä»¶çš„ Pod éƒ½ä¼šè¢«åˆ—å‡ºæ¥ï¼ŒåŒ…æ‹¬ CrashLoopBackOffã€‚


---

âœ… æ–¹æ³• 5ï¼šè¿‡æ»¤ restart è¿‡é«˜çš„ï¼ˆCrashLoop å¸¸ä¼´éšé«˜ restartCountï¼‰

kubectl get pods -o jsonpath='{range .items[*]}{.metadata.name}{"\t"}{.status.containerStatuses[*].restartCount}{"\n"}{end}' \
  | awk '$2 > 3'


---

ğŸ”¥ æ¨èæœ€ä½³ç»„åˆï¼ˆä½ å¤§æ¦‚ç‡å°±è¦è¿™ä¸ªï¼‰

è¿‡æ»¤æ‰€æœ‰ å¼‚å¸¸çŠ¶æ€ï¼ˆCrashLoopBackOff + Failed + Error + ImagePullBackOff + InitErrorï¼‰ï¼š

kubectl get pods --no-headers \
  | grep -E "CrashLoopBackOff|Error|Failed|ImagePullBackOff|Init"


---

å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘è¿˜å¯ä»¥å¸®ä½ å†™ä¸€ä¸ªï¼š

check_bad_pods.sh è„šæœ¬

è‡ªåŠ¨åˆ—å‡ºå¼‚å¸¸ Pod

æŒ‰åŸå› åˆ†ç±»ï¼šCrash / InitFail / ImagePullFail / NotReady


è¦ä¸è¦ï¼Ÿ