å¥½é—®é¢˜ ğŸ‘ ä½ ç¡®è®¤äº† AZ æ˜¯å¯¹çš„ï¼Œç°åœ¨æƒ³æŸ¥å¯¹åº”çš„ Subnet ä¿¡æ¯ï¼Œå…¶å®ä¹Ÿèƒ½ä» AWS CLI å¾ˆå¿«æŸ¥åˆ°ã€‚


---

1ï¸âƒ£ æ ¹æ®å®ä¾‹åæŸ¥ Subnetï¼ˆé€‚åˆå•å®ä¾‹æŸ¥è¯¢ï¼‰

aws rds describe-db-instances \
  --db-instance-identifier my-writer-instance \
  --query "DBInstances[0].DBSubnetGroup.Subnets[*].[SubnetIdentifier,SubnetAvailabilityZone.Name]" \
  --output table

è¾“å‡ºç¤ºä¾‹ï¼š

----------------------------------------------
|                DescribeDBInstances         |
+------------------------+-------------------+
| subnet-aaaa1111        | ap-southeast-2a   |
| subnet-bbbb2222        | ap-southeast-2b   |
| subnet-cccc3333        | ap-southeast-2c   |
----------------------------------------------

> è¿™ä¸ªä¼šåˆ—å‡º Subnet ID + æ‰€å± AZï¼Œæ–¹ä¾¿å¯¹åº”ã€‚




---

2ï¸âƒ£ å¦‚æœæ˜¯ Aurora é›†ç¾¤

å…ˆæŸ¥å‡ºé›†ç¾¤é‡Œçš„å®ä¾‹ï¼š

CLUSTER_ID=$(aws rds describe-db-instances \
  --db-instance-identifier my-writer-instance \
  --query "DBInstances[0].DBClusterIdentifier" \
  --output text)

ç„¶åæŸ¥ Subnetï¼š

aws rds describe-db-clusters \
  --db-cluster-identifier $CLUSTER_ID \
  --query "DBClusters[0].DBSubnetGroup.Subnets[*].[SubnetIdentifier,SubnetAvailabilityZone.Name]" \
  --output table


---

3ï¸âƒ£ å¦‚æœæƒ³æŸ¥ Subnet çš„ CIDR / VPC

æ‹¿åˆ° Subnet ID åï¼Œç”¨ EC2 CLI æŸ¥è¯¢ï¼š

aws ec2 describe-subnets \
  --subnet-ids subnet-aaaa1111 subnet-bbbb2222 subnet-cccc3333 \
  --query "Subnets[*].[SubnetId,CidrBlock,VpcId,AvailabilityZone]" \
  --output table

è¾“å‡ºç¤ºä¾‹ï¼š

+------------------------+---------------+-------------------+-------------------+
| subnet-aaaa1111        | 10.0.1.0/24  | vpc-xxxxxx        | ap-southeast-2a   |
| subnet-bbbb2222        | 10.0.2.0/24  | vpc-xxxxxx        | ap-southeast-2b   |
| subnet-cccc3333        | 10.0.3.0/24  | vpc-xxxxxx        | ap-southeast-2c   |
+------------------------+---------------+-------------------+-------------------+


---

æˆ‘é¡ºä¾¿é—®ä¸€ä¸‹â€”â€”ä½ æ˜¯æƒ³ç¡®è®¤ Writer å’Œ Readers å¯¹åº”çš„ Subnetï¼Œè¿˜æ˜¯æƒ³çœ‹ Subnet group é‡Œ 3 ä¸ª AZ çš„å­ç½‘å’Œå®é™…åˆ†é…æƒ…å†µï¼Ÿ
æˆ‘å¯ä»¥å¸®ä½ å†™ä¸ªå‘½ä»¤ç›´æ¥ä¸€æ¬¡æ€§æŠŠ å®ä¾‹å â†’ AZ â†’ Subnet ID â†’ CIDR å…¨æŸ¥å‡ºæ¥ï¼Œè¡¨æ ¼å½¢å¼ï¼Œå¾ˆé€‚åˆæ±‡æŠ¥ã€‚è¦ä¸è¦æˆ‘é¡ºä¾¿å¸®ä½ å¼„ä¸ªä¸€è¡Œè„šæœ¬ï¼Ÿ

