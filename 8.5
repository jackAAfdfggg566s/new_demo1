ä½ é—®å¾—å¾ˆç²¾å‡† ğŸ‘
ä½ ç”¨ AWS CLI æŸ¥è¯¢åˆ° RDS ä¸€ä¸ªå®ä¾‹å‡ºç°åœ¨ 3 ä¸ª AZï¼Œå…¶å®æ˜¯å› ä¸º CLI è¿”å›çš„æ˜¯å®ä¾‹çš„ Subnet Group ä¿¡æ¯æˆ–Aurora é›†ç¾¤å‰¯æœ¬ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å®ƒå®é™…è¿è¡Œçš„ AZã€‚

æˆ‘å¸®ä½ æ‹†ä¸€ä¸‹ä¸åŒæƒ…å†µï¼š


---

1ï¸âƒ£ å¦‚æœæ˜¯ä¼ ç»Ÿ RDSï¼ˆMySQL / PostgreSQL / Oracle / SQL Server é Auroraï¼‰

CLI é‡Œå¸¸è§å­—æ®µï¼š

aws rds describe-db-instances --db-instance-identifier <instance>

å…³é”®å­—æ®µï¼š

AvailabilityZoneï¼šå®ä¾‹å½“å‰è¿è¡Œçš„ AZï¼ˆåªæœ‰ä¸€ä¸ªï¼Œæ¯”å¦‚ ap-southeast-2aï¼‰ã€‚

DBSubnetGroup.Subnetsï¼šä¼šåˆ—å‡ºå¤šä¸ª AZï¼Œå› ä¸º subnet group é€šå¸¸åŒ…å« 2~3 ä¸ª AZï¼ˆä¾› Failover ç”¨ï¼‰ã€‚


ä¸ºä»€ä¹ˆ CLI ä¼šæ˜¾ç¤ºå¤šä¸ª AZï¼š

è¿™æ˜¯å› ä¸º subnet group æ”¯æŒå¤š AZ é€‰é¡¹ï¼Œå¹¶éå®ä¾‹çœŸçš„åœ¨æ¯ä¸ª AZ è·‘ã€‚

CLI è¾“å‡ºæ—¶ä¼šæŠŠ subnet group ä¸­çš„æ‰€æœ‰å­ç½‘ï¼ˆè·¨å¤šä¸ª AZï¼‰éƒ½åˆ—å‡ºæ¥ï¼Œçœ‹èµ·æ¥åƒå®ä¾‹â€œåœ¨ 3 ä¸ª AZâ€ã€‚




---

2ï¸âƒ£ å¦‚æœæ˜¯ Aurora é›†ç¾¤

CLI å‘½ä»¤ï¼š

aws rds describe-db-clusters --db-cluster-identifier <cluster>

AvailabilityZonesï¼šä¼šæ˜¾ç¤º 3 ä¸ª AZï¼ˆä¾‹å¦‚ ap-southeast-2a, ap-southeast-2b, ap-southeast-2cï¼‰ã€‚

åŸå› ï¼šAurora å­˜å‚¨å±‚å¤©ç„¶è·¨ 3 AZï¼Œé›†ç¾¤é…ç½®ä¹Ÿä¼šè®°å½•å®ƒèƒ½è¿è¡Œåœ¨å“ªäº› AZã€‚

é›†ç¾¤å®ä¾‹åˆ—è¡¨ (DBClusterMembers) ä¼šåˆ—å‡º Writer / Readerï¼Œå¯èƒ½åˆ†å¸ƒåœ¨ä¸åŒ AZã€‚




---

3ï¸âƒ£ ä½ å¯èƒ½çœ‹åˆ°çš„ CLI è¾“å‡ºæ ·ä¾‹

ä¸¾ä¸ªä¾‹å­ï¼ˆAurora é›†ç¾¤ï¼‰ï¼š

{
    "DBCluster": {
        "AvailabilityZones": [
            "ap-southeast-2a",
            "ap-southeast-2b",
            "ap-southeast-2c"
        ],
        "DBClusterMembers": [
            {
                "DBInstanceIdentifier": "my-writer",
                "IsClusterWriter": true,
                "PromotionTier": 1
            },
            {
                "DBInstanceIdentifier": "my-reader-1",
                "IsClusterWriter": false,
                "PromotionTier": 2
            }
        ]
    }
}

ğŸ‘‰ è¿™é‡Œçš„ AvailabilityZones åªæ˜¯è¡¨æ˜é›†ç¾¤èƒ½å®¹é”™åˆ°è¿™äº› AZï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªå®ä¾‹éƒ½åœ¨æ‰€æœ‰ AZ è·‘ã€‚


---

æˆ‘çŒœä½ æŸ¥è¯¢åˆ°çš„ç»“æœå¯èƒ½æ˜¯ describe-db-instances æˆ– describe-db-clusters è¿”å›äº†å¤šä¸ª AZï¼Œå¯¼è‡´ä½ è§‰å¾—â€œä¸€ä¸ªå®ä¾‹åœ¨ 3 AZâ€ã€‚

å¦‚æœä½ æ–¹ä¾¿ï¼Œæˆ‘å¯ä»¥å¸®ä½ åˆ†æä¸€ä¸‹ä½  AWS CLI çš„å…·ä½“è¿”å›å­—æ®µï¼Œä¸€çœ¼å‘Šè¯‰ä½ è¿™æ˜¯å› ä¸º Subnet Group é…ç½®è¿˜æ˜¯ Aurora é›†ç¾¤å¤š AZ å­˜å‚¨ã€‚
è¦ä¸è¦ä½ æŠŠ CLI è¾“å‡ºè´´ä¸€æ®µï¼ˆå¯ä»¥éšè—å®ä¾‹åï¼‰æˆ‘å¸®ä½ åˆ¤æ–­ï¼Ÿ

