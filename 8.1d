å•Šï¼Œä½ æŠ“å¾—å¾ˆå‡† ğŸ‘
æˆ‘åˆšæ‰å†™çš„ç¡®å®æ˜¯ DBSubnetGroup.VpcIdï¼Œè€Œä½ æƒ³è¦çš„å…¶å®æ˜¯ RDS å½“å‰ç»‘å®šçš„ Subnet ä¿¡æ¯ï¼Œä¸æ˜¯ VPCã€‚


---

1ï¸âƒ£ è·å– RDS çš„ Subnet ä¿¡æ¯

AWS CLIï¼š

aws rds describe-db-instances \
  --db-instance-identifier <ä½ çš„å®ä¾‹ID> \
  --query "DBInstances[0].DBSubnetGroup.Subnets[*].SubnetIdentifier" \
  --output text

ç¤ºä¾‹è¾“å‡ºï¼ˆå¯èƒ½æœ‰å¤šä¸ª Subnetï¼‰ï¼š

subnet-0aaa1111 subnet-0bbb2222 subnet-0ccc3333


---

2ï¸âƒ£ åŒæ—¶è·å–å½“å‰ AZ + Subnet

aws rds describe-db-instances \
  --db-instance-identifier <ä½ çš„å®ä¾‹ID> \
  --query "DBInstances[0].[AvailabilityZone, DBSubnetGroup.Subnets[*].SubnetIdentifier]" \
  --output text

ç¤ºä¾‹è¾“å‡ºï¼š

ap-southeast-2a   subnet-0aaa1111 subnet-0bbb2222 subnet-0ccc3333


---

3ï¸âƒ£ å¦‚æœä½ åªæƒ³è·å–å½“å‰ AZ å¯¹åº”çš„ Subnet

RDS ä¼šåœ¨å¤šä¸ª AZ çš„ Subnet ä¸­é€‰æ‹©ä¸€ä¸ªå¯¹åº”å½“å‰ AZ çš„ Subnetï¼Œä½ å¯ä»¥é€šè¿‡ AvailabilityZone å’Œ SubnetAvailabilityZone åŒ¹é…ï¼š

aws rds describe-db-instances \
  --db-instance-identifier <ä½ çš„å®ä¾‹ID> \
  --query "DBInstances[0].DBSubnetGroup.Subnets[?SubnetAvailabilityZone.Name=='$(aws rds describe-db-instances --db-instance-identifier <ä½ çš„å®ä¾‹ID> --query "DBInstances[0].AvailabilityZone" --output text)'].SubnetIdentifier" \
  --output text

è¿™ä¸ªå‘½ä»¤ä¼šï¼š

1. å…ˆæ‹¿å½“å‰ AZ


2. å†è¿‡æ»¤å‡ºè¯¥ AZ å¯¹åº”çš„ Subnet




---

æˆ‘æ„Ÿè§‰ä½ è¿™ä¸ªéœ€æ±‚æ˜¯ä¸ºäº† Single-AZ Failover æ—¶é€‰å¯¹ Subnetï¼ˆæ¯”å¦‚åˆ‡åˆ°å¦ä¸€ä¸ª AZ çš„ Subnetï¼‰ï¼Œå¯¹å§ï¼Ÿ
å¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘å¯ä»¥å¸®ä½ å†™ä¸ªå®Œæ•´é€»è¾‘ï¼š
ğŸ‘‰ è·å–å½“å‰ AZ â†’ æ‰¾åˆ°å¦ä¸€ä¸ª AZ å¯¹åº”çš„ Subnet â†’ è‡ªåŠ¨ modify-db-instance åˆ‡æ¢è¿‡å»ã€‚
è¦ä¸è¦æˆ‘å¸®ä½ æ‹¼ä¸ªä¸€é”®è„šæœ¬ï¼Ÿè¿™æ ·ç›´æ¥é€‚åˆ GitLab CIã€‚

