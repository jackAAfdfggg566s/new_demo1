è¿™ä¸ªé—®é¢˜é—®å¾—éå¸¸å…³é”®ï¼Œè€Œä¸”æ­£å¥½å¡åœ¨ FIS é‡Œæœ€å®¹æ˜“è¢«è¯¯ç”¨çš„ç‚¹ã€‚æˆ‘ç›´æ¥ç»™ä½ ä¸€ä¸ª**â€œåŸç† â†’ è§„åˆ™ â†’ æ­£ç¡®ç”¨æ³•â€**çš„å®Œæ•´è§£é‡Šã€‚
ä¸€ã€ä¸ºä»€ä¹ˆè¿™ä¸ª action é‡Œ targets æ˜¯ç©ºçš„ï¼Ÿ
ç»“è®ºå…ˆè¡Œ
ğŸ‘‰ aws:ec2:simulate-insufficient-instance-capacity æ˜¯â€œå…¨å±€æ§åˆ¶é¢æ³¨å…¥â€åŠ¨ä½œï¼Œä¸ä½œç”¨åœ¨å…·ä½“èµ„æºä¸Š
æ‰€ä»¥ ä¸éœ€è¦ã€ä¹Ÿä¸èƒ½æŒ‡å®š targetã€‚
1ï¸âƒ£ å’Œ terminate-instances çš„æœ¬è´¨åŒºåˆ«
terminate-instances
ä½œç”¨å¯¹è±¡ï¼šå…·ä½“ EC2 å®ä¾‹
æ‰€ä»¥å¿…é¡»ï¼š
å¤åˆ¶ä»£ç 
Json
"targets": {
  "Instances": "MyInstances"
}
simulate-insufficient-instance-capacity
ä½œç”¨å¯¹è±¡ï¼šEC2 æ§åˆ¶é¢ï¼ˆRunInstances / ASG launchï¼‰
æ§åˆ¶çš„æ˜¯ï¼š
å“ªä¸ª AZ
å“ªç§ InstanceType
âŒ ä¸æ˜¯æŸå‡ å°å®ä¾‹
ğŸ‘‰ å› æ­¤ï¼š
å¤åˆ¶ä»£ç 
Json
"targets": {}
æ˜¯æ­£ç¡®ã€å®˜æ–¹ã€å¿…é¡»çš„å†™æ³•
2ï¸âƒ£ å®˜æ–¹è¯­ä¹‰ï¼ˆä½ å¯ä»¥ç›´æ¥å†™è¿›æ–‡æ¡£ï¼‰
This action does not require targets because it injects failures at the EC2 control plane level rather than acting on specific resources.
äºŒã€é‚£ percentage æ˜¯ä»€ä¹ˆï¼Ÿåˆ°åº•å½±å“è°ï¼Ÿ
percentage æ˜¯ FIS Action å‚æ•°
ğŸ‘‰ æ§åˆ¶â€œå¤±è´¥æ³¨å…¥æ¦‚ç‡â€
1ï¸âƒ£ percentage çš„çœŸå®å«ä¹‰ï¼ˆéå¸¸é‡è¦ï¼‰
For matching RunInstances requests, what percentage should fail with InsufficientInstanceCapacity.
ä¹Ÿå°±æ˜¯è¯´ï¼š
æ¯ä¸€æ¬¡ å®ä¾‹å¯åŠ¨è¯·æ±‚
æŒ‰ percentage æ¦‚ç‡ï¼š
è¿”å› InsufficientInstanceCapacity
æˆ–æ­£å¸¸æˆåŠŸ
2ï¸âƒ£ ç¤ºä¾‹è¯´æ˜ï¼ˆç”¨ ASG æ›´å¥½ç†è§£ï¼‰
å‡è®¾ï¼š
ASG scale out 10 å°
percentage = 50
ç»“æœå¯èƒ½æ˜¯ï¼š
5 æ¬¡ launchï¼š
å¤åˆ¶ä»£ç 

InsufficientInstanceCapacity
5 æ¬¡ launchï¼š
æˆåŠŸï¼ˆå¯èƒ½åœ¨å…¶ä»– AZ / instance typeï¼‰
âš ï¸ ä¸æ˜¯ä¸€æ¬¡æ€§å†³å®šï¼Œè€Œæ˜¯â€œæ¯æ¬¡è¯·æ±‚ç‹¬ç«‹åˆ¤æ–­â€
3ï¸âƒ£ å¸¸è§è¯¯è§£ï¼ˆä¸€å®šè¦é¿å¼€ï¼‰
âŒ è¯¯è§£ï¼š
â€œpercentage=100 è¡¨ç¤º 100% AZ æŒ‚äº†â€
âœ… æ­£ç¡®ï¼š
è¡¨ç¤ºï¼š
100% çš„æ–°å»ºå®ä¾‹è¯·æ±‚å¤±è´¥
ä»…é™ï¼š
æŒ‡å®š AZ
æŒ‡å®š instance type
ä¸‰ã€æ­£ç¡®ç”¨æ³•æ¨èï¼ˆæŒ‰æµ‹è¯•ç›®çš„ï¼‰
âœ… æ¨è 1ï¼šAZ å®Œå…¨ä¸å¯æ‰©å®¹ï¼ˆæœ€å¸¸ç”¨ï¼‰
å¤åˆ¶ä»£ç 
Json
"percentage": 100
ç”¨é€”ï¼š
éªŒè¯ï¼š
ASG / EKS æ˜¯å¦ 100% fail over
ä¸ä¼šæ­»ç£•ä¸€ä¸ª AZ
ğŸŸ¡ æ¨è 2ï¼šå®¹é‡æŠ–åŠ¨ï¼ˆé«˜çº§ï¼‰
å¤åˆ¶ä»£ç 
Json
"percentage": 30
ç”¨é€”ï¼š
æ¨¡æ‹Ÿï¼š
AZ å®¹é‡ä¸ç¨³å®š
Spot æŠ¢å  / çƒ­ç‚¹æ—¶æ®µ
éªŒè¯ï¼š
é‡è¯•
backoff
fallback ç­–ç•¥
âŒ ä¸æ¨èï¼ˆé™¤éä½ éå¸¸æ¸…æ¥šï¼‰
å¤åˆ¶ä»£ç 
Json
"percentage": 1~5
åŸå› ï¼š
éš¾å¤ç°
éš¾è§£é‡Š
reviewer å¾ˆå®¹æ˜“ challenge ä½ 
å››ã€ä¸€ä¸ªâ€œå®Œå…¨æ­£ç¡®â€çš„ Action ç¤ºä¾‹ï¼ˆå¸¦ percentageï¼‰
å¤åˆ¶ä»£ç 
Json
"actions": {
  "BlockCapacityInAzA": {
    "actionId": "aws:ec2:simulate-insufficient-instance-capacity",
    "parameters": {
      "availabilityZoneIdentifiers": ["ap-southeast-2a"],
      "instanceTypeIdentifiers": ["m6i.large"],
      "percentage": "100"
    }
  }
}
æ³¨æ„ï¼špercentage æ˜¯ å­—ç¬¦ä¸²
äº”ã€ä½ åœ¨è¯„å®¡é‡Œå¯ä»¥è¿™æ ·è§£é‡Šï¼ˆç›´æ¥å¯ç”¨ï¼‰
This action does not define targets because it injects failures at the EC2 control plane level.
The percentage parameter controls the probability that instance launch requests in the specified AZ and instance type will fail with InsufficientInstanceCapacity.
å…­ã€å¸¸è§ reviewer ä¼šé—®çš„é—®é¢˜ï¼ˆæå‰å‡†å¤‡ï¼‰
Qï¼šä¸ºä»€ä¹ˆä¸æŒ‡å®š instanceï¼Ÿ
Because the failure occurs before any instance is created.
Qï¼šä¸ºä»€ä¹ˆ 100%ï¼Ÿ
To deterministically validate AZ-level scale-out failover.
Qï¼šç°æœ‰å®ä¾‹ä¼šå—å½±å“å—ï¼Ÿ
No. Only new capacity provisioning is affected.
æœ€åä¸€å¥æ€»ç»“
âœ… targets = {} æ˜¯ å¿…é¡»ä¸”æ­£ç¡®
âœ… percentage = å¯åŠ¨å¤±è´¥æ¦‚ç‡
âœ… è¿™æ˜¯ä¸€ä¸ª scale-time AZ failover æ³¨å…¥
å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥ä¸‹ä¸€æ­¥ç›´æ¥å¸®ä½ ï¼š
ğŸ§ª è®¾è®¡ä¸€ä¸ª 2-phase Chaosï¼ˆterminate â†’ insufficientï¼‰
ğŸ“Š ç»™ä½ ä¸€ä»½ ASG / EKS éªŒè¯æŒ‡æ ‡æ¸…å•
ğŸ” Review ä½ ç°åœ¨çš„ FIS JSON æ˜¯å¦ production-grade