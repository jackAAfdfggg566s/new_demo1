æ˜ç™½äº†ï¼Œä½ çš„éœ€æ±‚æ˜¯ï¼š

> å…ˆæŸ¥å‡ºæ‰€æœ‰ readerï¼ˆåªè¯»å‰¯æœ¬ï¼‰å®ä¾‹çš„ identifierï¼Œå†æŸ¥å‡ºå®ƒä»¬å¯¹åº”çš„ endpoint åœ°å€ã€‚



é€‚ç”¨äº é Auroraï¼ˆæ™®é€š RDS + Read Replicaï¼‰åœºæ™¯ã€‚


---

âœ… ä¸€æ¡å‘½ä»¤æå®šï¼šåˆ—å‡ºæ‰€æœ‰åªè¯»å‰¯æœ¬åŠå…¶ endpoint

aws rds describe-db-instances \
  --query 'DBInstances[?ReadReplicaSourceDBInstanceIdentifier!=null].[DBInstanceIdentifier,Endpoint.Address]' \
  --output table

è¾“å‡ºç¤ºä¾‹ï¼š

-------------------------------
|  DescribeDbInstances       |
+-----------------+----------+
|  mydb-read-1    | mydb-read-1.abc.rds.amazonaws.com |
|  mydb-read-2    | mydb-read-2.def.rds.amazonaws.com |
+-----------------+----------+


---

âœ… å¦‚æœä½ è¦è„šæœ¬å˜é‡å½¢å¼ï¼š

aws rds describe-db-instances \
  --query 'DBInstances[?ReadReplicaSourceDBInstanceIdentifier!=null].[DBInstanceIdentifier,Endpoint.Address]' \
  --output text

è¾“å‡ºç±»ä¼¼ï¼š

mydb-read-1  mydb-read-1.abc.rds.amazonaws.com
mydb-read-2  mydb-read-2.def.rds.amazonaws.com

ä½ å¯ä»¥å¾ªç¯å¤„ç†ï¼š

read_replicas=$(aws rds describe-db-instances \
  --query 'DBInstances[?ReadReplicaSourceDBInstanceIdentifier!=null].[DBInstanceIdentifier,Endpoint.Address]' \
  --output text)

echo "$read_replicas" | while read identifier endpoint; do
  echo "Replica: $identifier, Endpoint: $endpoint"
done


---

ğŸ” å¦‚æœä½ åªæƒ³å–å…¶ä¸­ä¸€ä¸ªï¼Œä¾‹å¦‚ç¬¬ä¸€ä¸ª reader çš„ endpointï¼š

aws rds describe-db-instances \
  --query 'DBInstances[?ReadReplicaSourceDBInstanceIdentifier!=null].[Endpoint.Address]' \
  --output text | head -n1


---

å¦‚æœä½ æœ‰æ›´å¤šéœ€æ±‚ï¼Œæ¯”å¦‚è¿‡æ»¤æŸä¸ªä¸»å®ä¾‹çš„å‰¯æœ¬ï¼Œæˆ–åªè¦æŸä¸ª regionï¼Œæˆ‘ä¹Ÿå¯ä»¥åŠ ä¸Šã€‚

è¦ä¸è¦æˆ‘å¸®ä½ å†™ä¸ªå¸¦ grep æˆ– jq çš„å¤æ‚è¿‡æ»¤ï¼Ÿ

